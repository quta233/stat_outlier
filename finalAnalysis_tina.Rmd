---
title: "finalAnalysis_tina"
author: "Tina Liu"
date: "2020/1/20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(Stat2Data)
library(mosaic)
library(car)
library(outliers)
library(tidyverse)
library(sn)
``` 

```{r}
record <- read_csv("WT Data Record .csv")
```

```{r}
record
```


```{r}
record <- record %>%
  filter(!is.na(N)) %>%
  rename("setName" = "SetName",
         "size" = "Size",
         "n" = "N",
         "distribution" = "Distribution",
         "csq" = "CSQ",
         "cook" = "COOK",
         "iqr" = "IQR",
         "sd" = "SD",
         "bonf" = "BONF")
```



```{r}
record <- record %>%
  mutate(pcsq = csq / n,
         pcook = cook / n,
         piqr = iqr / n,
         psd = sd / n,
         pbonf = bonf / n)
```


```{r}
record %>%
  group_by(distribution) %>%
  summarize(mcsq = mean(pcsq),
            mcook = mean(pcook),
            miqr = mean(piqr),
            msd = mean(psd),
            mbonf = mean(pbonf))
```


```{r}
#record %>% ggplot(aes(x = N, y = SetName)) +
 # geom_point()
```

```{r}
record <- record %>% mutate(id = seq.int(nrow(record)))
```

```{r}
record
```


```{r}
rlm1 <- glm(pcsq~id, data=record)
summary(rlm1)
gf_point(pcsq ~id,
data = record) %>%
gf_smooth(linetype = "dashed",
color = "red") %>%
gf_lm(size = 1.5)

rlm2 <- glm(pcook~id, data=record)
summary(rlm2)
gf_point(pcook ~id,
data = record) %>%
gf_smooth(linetype = "dashed",
color = "red") %>%
gf_lm(size = 1.5)

rlm3 <- glm(piqr~id, data=record)
summary(rlm3)
gf_point(piqr ~id,
data = record) %>%
gf_smooth(linetype = "dashed",
color = "red") %>%
gf_lm(size = 1.5)

rlm4 <- glm(psd~id, data=record)
summary(rlm4)
gf_point(psd ~id,
data = record) %>%
gf_smooth(linetype = "dashed",
color = "red") %>%
gf_lm(size = 1.5)

rlm5 <- glm(pbonf~id, data=record)
summary(rlm5)
gf_point(pbonf ~id,
data = record) %>%
gf_smooth(linetype = "dashed",
color = "red") %>%
gf_lm(size = 1.5)
```












